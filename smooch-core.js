(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.SmoochCore = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.AppUsersApi=void 0;var _base=require("./base"),_appUsersStripe=require("./appUsersStripe"),_appUsersViber=require("./appUsersViber"),_appUsersWeChat=require("./appUsersWeChat"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),AppUsersApi=exports.AppUsersApi=function(e){function t(){_classCallCheck(this,t);for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];var o=_possibleConstructorReturn(this,e.call.apply(e,[this].concat(s)));return o.stripe=new(Function.prototype.bind.apply(_appUsersStripe.AppUsersStripeApi,[null].concat(s))),o.viber=new(Function.prototype.bind.apply(_appUsersViber.AppUsersViberApi,[null].concat(s))),o.wechat=new(Function.prototype.bind.apply(_appUsersWeChat.AppUsersWeChatApi,[null].concat(s))),o}return _inherits(t,e),t}(_base.BaseApi);Object.assign(AppUsersApi.prototype,{init:(0,_smoochMethod2.default)({params:["props"],path:"/init",method:"POST"}),create:(0,_smoochMethod2.default)({params:["userId","props"],optional:["props"],path:"/appusers",func:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||!t.trim())return Promise.reject(new Error("Must provide a userId."));var s=Object.assign({userId:t},r);return!r.signedUpAt||r.signedUpAt instanceof Date?this.request("POST",e,s,{allowedAuth:["jwt"]}):Promise.reject(new Error("signedUpAt must be a date."))}}),get:(0,_smoochMethod2.default)({params:["userId"],path:"/appusers/:userId",method:"GET"}),update:(0,_smoochMethod2.default)({params:["userId","props"],path:"/appusers/:userId",method:"PUT"}),trackEvent:(0,_smoochMethod2.default)({params:["userId","eventName","props"],optional:["props"],path:"/appusers/:userId/events",func:function(e,t,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.request("POST",e,{name:r,appUser:s})}}),updatePushToken:(0,_smoochMethod2.default)({params:["userId","deviceId","token"],path:"/appusers/:userId/pushToken",func:function(e,t,r,s){return this.request("POST",e,{deviceId:r,token:s})}}),updateDevice:(0,_smoochMethod2.default)({params:["userId","deviceId","props"],path:"/appusers/:userId/devices/:deviceId",method:"PUT"}),linkChannel:(0,_smoochMethod2.default)({params:["userId","data"],path:"/appusers/:userId/channels",method:"POST"}),unlinkChannel:(0,_smoochMethod2.default)({params:["userId","channel"],path:"/appusers/:userId/channels/:channel",method:"DELETE"}),pingChannel:(0,_smoochMethod2.default)({params:["userId","channel"],path:"/appusers/:userId/integrations/:channel/ping",func:function(e){return this.request("POST",e)}}),getMessages:(0,_smoochMethod2.default)({params:["userId","query"],optional:["query"],path:"/appusers/:userId/messages",func:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=r.before,a=r.after;if(s&&a)return Promise.reject(new Error('Parameters "before" and "after" are mutually exclusive. You must provide one or the other.'));var o=s?{before:s}:a?{after:a}:void 0;return this.request("GET",e,o)}}),sendMessage:(0,_smoochMethod2.default)({params:["userId","message"],path:"/appusers/:userId/messages",method:"POST"}),uploadImage:(0,_smoochMethod2.default)({params:["userId","source","message"],optional:["message"],path:"/appusers/:userId/images",func:function(e,t,r){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=new FormData;return a.append("source",r),Object.keys(s).forEach(function(e){a.append(e,s[e])}),this.request("POST",e,a)}}),typingActivity:(0,_smoochMethod2.default)({params:["userId","activityProps"],path:"/appusers/:userId/conversation/activity",method:"POST"})});

},{"../utils/smoochMethod":11,"./appUsersStripe":2,"./appUsersViber":3,"./appUsersWeChat":4,"./base":5}],2:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.AppUsersStripeApi=void 0;var _base=require("./base"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),AppUsersStripeApi=exports.AppUsersStripeApi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t}(_base.BaseApi);Object.assign(AppUsersStripeApi.prototype,{updateCustomer:(0,_smoochMethod2.default)({params:["userId","token"],path:"/appusers/:userId/stripe/customer",func:function(e,t,r){return r?this.request("POST",e,{token:r},{allowedAuth:["jwt"]}):Promise.reject(new Error("Must provide a Stripe token."))}}),createTransaction:(0,_smoochMethod2.default)({params:["userId","actionId","token"],optional:["token"],path:"/appusers/:userId/stripe/transaction",func:function(e,t,r,o){if(!r)return Promise.reject(new Error("Must provide an action id."));var s={actionId:r};return o&&Object.assign(s,{token:o}),this.request("POST",e,s)}})});

},{"../utils/smoochMethod":11,"./base":5}],3:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.AppUsersViberApi=void 0;var _base=require("./base"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),AppUsersViberApi=exports.AppUsersViberApi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t}(_base.BaseApi);Object.assign(AppUsersViberApi.prototype,{getQRCode:(0,_smoochMethod2.default)({params:["userId"],path:"/appusers/:userId/integrations/viber/qrcode",method:"GET"})});

},{"../utils/smoochMethod":11,"./base":5}],4:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.AppUsersWeChatApi=void 0;var _base=require("./base"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),AppUsersWeChatApi=exports.AppUsersWeChatApi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t}(_base.BaseApi);Object.assign(AppUsersWeChatApi.prototype,{getQRCode:(0,_smoochMethod2.default)({params:["userId"],path:"/appusers/:userId/integrations/wechat/qrcode",method:"GET"})});

},{"../utils/smoochMethod":11,"./base":5}],5:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0,exports.BaseApi=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_http=require("../utils/http"),BaseApi=exports.BaseApi=function(){function e(t,r,s,a){_classCallCheck(this,e),this.serviceUrl=t,this.authHeaders=r,this.headers=s,this.requireAppId=!!a,this.allowedAuth=["jwt","appToken"]}return e.prototype.validateAuthHeaders=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.allowedAuth;if(!e||0===e.length)return Promise.reject(new Error("Must at least provide one authentication method."));if(!this.authHeaders)return Promise.reject(new Error("Must provide headers."));var t=e.indexOf("jwt")>=0,r=e.indexOf("appToken")>=0,s=!!this.authHeaders.Authorization,a=!!this.authHeaders["app-token"];return!t&&s?Promise.reject(new Error("Must not use JWT for authentication.")):!r&&a?Promise.reject(new Error("Must not use an app token for authentication.")):Promise.resolve()},e.prototype.request=function(e,t,r){var s=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=a.allowedAuth,n=void 0===o?this.allowedAuth:o;return this.validateAuthHeaders(n).then(function(){return(0,_http.http)(e,t,r,s.getHeaders())})},e.prototype.getHeaders=function(){return _extends({},this.headers,this.authHeaders)},e}();
},{"../utils/http":10}],6:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.ConversationsApi=void 0;var _base=require("./base"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),ConversationsApi=exports.ConversationsApi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t}(_base.BaseApi);Object.assign(ConversationsApi.prototype,{get:(0,_smoochMethod2.default)({params:["userId"],path:"/appusers/:userId/conversation",method:"GET"}),postPostback:(0,_smoochMethod2.default)({params:["userId","actionId"],path:"/appusers/:userId/conversation/postback",func:function(e,t,r){if(!r)return Promise.reject(new Error("Must provide an action id."));var o={actionId:r};return this.request("POST",e,o)}}),resetUnreadCount:(0,_smoochMethod2.default)({params:["userId"],path:"/appusers/:userId/conversation/read",func:function(e){return this.request("POST",e)}}),sendMessage:function(){return Promise.reject(new Error("This endpoint is deprecated. Please use appUsers.sendMessage() instead."))},uploadImage:function(){return Promise.reject(new Error("This endpoint is deprecated. Please use appUsers.uploadImage() instead."))}});

},{"../utils/smoochMethod":11,"./base":5}],7:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}exports.__esModule=!0,exports.StripeApi=void 0;var _base=require("./base"),_smoochMethod=require("../utils/smoochMethod"),_smoochMethod2=_interopRequireDefault(_smoochMethod),StripeApi=exports.StripeApi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,e.apply(this,arguments))}return _inherits(t,e),t}(_base.BaseApi);Object.assign(StripeApi.prototype,{getAccount:(0,_smoochMethod2.default)({params:[],path:"/stripe/account",method:"GET"})});

},{"../utils/smoochMethod":11,"./base":5}],8:[function(require,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}exports.__esModule=!0,exports.Smooch=exports.SERVICE_URL=void 0;var _auth=require("./utils/auth"),_appUsers=require("./api/appUsers"),_conversations=require("./api/conversations"),_stripe=require("./api/stripe"),_package=require("../package.json"),_package2=_interopRequireDefault(_package),SERVICE_URL=exports.SERVICE_URL="https://api.smooch.io/v1",Smooch=exports.Smooch=function e(){var s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e);var t=r.serviceUrl,i=void 0===t?SERVICE_URL:t,a=r.headers,o=void 0===a?{}:a;if(this.VERSION=_package2.default.version,this.serviceUrl=i,this.scope="appUser",s.keyId||s.secret)throw new Error("Key Id or Secret should not be used on the browser side. You must generate a JWT beforehand.");this.headers=o,this.authHeaders=(0,_auth.getAuthenticationHeaders)(s),this.appUsers=new _appUsers.AppUsersApi(this.serviceUrl,this.authHeaders,this.headers),this.conversations=new _conversations.ConversationsApi(this.serviceUrl,this.authHeaders,this.headers),this.stripe=new _stripe.StripeApi(this.serviceUrl,this.authHeaders,this.headers),this.utils={}};
},{"../package.json":15,"./api/appUsers":1,"./api/conversations":6,"./api/stripe":7,"./utils/auth":9}],9:[function(require,module,exports){
"use strict";function getAuthenticationHeaders(t){if(!t)throw new Error("Must provide authentication information.");if(t.jwt)return{Authorization:"Bearer "+t.jwt};if(t.appToken)return{"app-token":t.appToken};throw new Error("Must provide a JWT or a app token")}exports.__esModule=!0,exports.getAuthenticationHeaders=getAuthenticationHeaders;

},{}],10:[function(require,module,exports){
(function (process){
"use strict";function stringifyGETParams(e,t){var n=Object.keys(t).reduce(function(e,n){return null!==t[n]?e+"&"+encodeURIComponent(n)+"="+encodeURIComponent(t[n]):e},"");return n&&(e+=(~e.indexOf("?")?"&":"?")+n.substring(1)),e}function handleStatus(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}function handleBody(e){if(202===e.status||204===e.status)return Promise.resolve();var t=e.headers.get("Content-Type")||"",n=t.indexOf("application/json")>-1;return n?e.json():Promise.resolve()}function http(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=e.toUpperCase();var r={method:e,headers:Object.assign({Accept:"application/json","Content-Type":"application/json"},s)};return n&&(n instanceof FormData?(r.body=n,delete r.headers["Content-Type"]):(n=Object.assign({},n),"GET"===e?t=stringifyGETParams(t,n):"POST"!==e&&"PUT"!==e||(r.body=JSON.stringify(n)))),fetch(t,r).then(handleStatus).then(handleBody)}exports.__esModule=!0,exports.stringifyGETParams=stringifyGETParams,exports.handleStatus=handleStatus,exports.handleBody=handleBody,exports.http=http,"undefined"!=typeof process&&require("isomorphic-fetch");
}).call(this,require('_process'))
},{"_process":13,"isomorphic-fetch":12}],11:[function(require,module,exports){
"use strict";function smoochMethod(e){var r=e.params,t=e.optional,o=void 0===t?[]:t,n=e.path,i=e.method,a=e.func;if(!r||!n)throw new Error("params and path are required");if(!i&&!a)throw new Error("at least one of func or method are required");if(i&&a)throw new Error("func and method are mutually exclusive");var c=a?a.name:i+" "+n;return function(){var e=arguments,t=void 0,p=void 0,u=n;this.requireAppId?(p=["appId"].concat(r),u="/apps/:appId"+n):p=[].concat(r);var s=p.filter(function(e){return!o.includes(e)});if("object"===_typeof(arguments[0])&&1===arguments.length?!function(){var r=e[0];p.includes("props")&&"object"!==_typeof(r.props)?t=[r]:(t=[],p.forEach(function(e){var o=r[e],n=s.includes(e);if(!o&&n)throw new Error(c+": missing required argument: "+e);o&&t.push(o)}))}():t=[].concat(Array.prototype.slice.call(arguments)),t.length<s.length)throw new Error(c+": incorrect number of parameters ("+t.length+"). Expected at least "+s.length);if(t.length>p.length)throw new Error(c+": incorrect number of parameters ("+t.length+"). Expected at most "+r.length);p.forEach(function(e,r){t[r]&&u.includes(":"+e)&&(u=u.replace(":"+e,t[r]))});var l=this.serviceUrl+u;return i?["POST","PUT"].includes(i)?this.request(i,l,t.pop()):this.request(i,l):(this.requireAppId?t[0]=l:t.unshift(l),a.apply(this,t))}}exports.__esModule=!0;var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};exports.default=smoochMethod;

},{}],12:[function(require,module,exports){
require("whatwg-fetch"),module.exports=self.fetch.bind(self);
},{"whatwg-fetch":14}],13:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)t[u-1]=arguments[u];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};
},{}],14:[function(require,module,exports){
!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function n(t){this.map={},t instanceof n?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function s(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function i(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function a(t){var e=new FileReader;return e.readAsArrayBuffer(t),i(e)}function h(t){var e=new FileReader;return e.readAsText(t),i(e)}function u(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(t){if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob?(this.blob=function(){var t=s(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(a)},this.text=function(){var t=s(this);if(t)return t;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=s(this);return t?t:Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return b.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var r=e.body;if(d.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new n(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new n(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(n))}}),e}function c(t){var e=new n,r=(t.getAllResponseHeaders()||"").trim().split("\n");return r.forEach(function(t){var r=t.trim().split(":"),o=r.shift().trim(),n=r.join(":").trim();e.append(o,n)}),e}function l(t,e){e||(e={}),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof n?e.headers:new n(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};n.prototype.append=function(t,o){t=e(t),o=r(o);var n=this.map[t];n||(n=[],this.map[t]=n),n.push(o)},n.prototype.delete=function(t){delete this.map[e(t)]},n.prototype.get=function(t){var r=this.map[e(t)];return r?r[0]:null},n.prototype.getAll=function(t){return this.map[e(t)]||[]},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(t,o){this.map[e(t)]=[r(o)]},n.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(o){t.call(e,o,r,this)},this)},this)},n.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),o(t)},n.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},n.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),o(t)},y.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this)},u.call(d.prototype),u.call(l.prototype),l.prototype.clone=function(){return new l(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},l.error=function(){var t=new l(null,{status:0,statusText:""});return t.type="error",t};var m=[301,302,303,307,308];l.redirect=function(t,e){if(m.indexOf(e)===-1)throw new RangeError("Invalid status code");return new l(null,{status:e,headers:{location:t}})},t.Headers=n,t.Request=d,t.Response=l,t.fetch=function(t,e){return new Promise(function(r,o){function n(){return"responseURL"in i?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):void 0}var s;s=d.prototype.isPrototypeOf(t)&&!e?t:new d(t,e);var i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:c(i),url:n()},e="response"in i?i.response:i.responseText;r(new l(e,t))},i.onerror=function(){o(new TypeError("Network request failed"))},i.ontimeout=function(){o(new TypeError("Network request failed"))},i.open(s.method,s.url,!0),"include"===s.credentials&&(i.withCredentials=!0),"responseType"in i&&y.blob&&(i.responseType="blob"),s.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof s._bodyInit?null:s._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this);
},{}],15:[function(require,module,exports){
module.exports={
  "name": "smooch-core",
  "version": "3.3.0",
  "description": "Javascript wrapper for Smooch API",
  "homepage": "https://smooch.io",
  "main": "lib/wrappers/node.js",
  "browser": "lib/wrappers/browser.js",
  "scripts": {
    "test": "mocha --compilers js:babel-core/register --require ./test-setup.js ./test/**/*.spec.js",
    "test-ci": "MOCHA_FILE=$CIRCLE_TEST_REPORTS/test-results.xml mocha --compilers js:babel-core/register -R mocha-junit-reporter --require ./test-setup.js ./test/**/*.spec.js",
    "build": "mkdir -p lib && rm -rf lib/* && babel -d lib/ src/ && npm run browserify:dist",
    "browserify:dev": "mkdir -p amd && browserify -g uglifyify -e lib/smooch.js -s SmoochCore -o amd/smooch-core.js",
    "browserify:dist": "npm run browserify:dev && uglifyjs amd/smooch-core.js -c -o amd/smooch-core.min.js --screw-ie8",
    "release": "release",
    "docs": "jsdoc src/api -t node_modules/minami",
    "lint": "eslint . --ext=js"
  },
  "author": "Marc-Antoine Lemieux",
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "git@github.com:smooch/smooch-core-js.git"
  },
  "devDependencies": {
    "babel": "6.5.2",
    "babel-cli": "6.9.0",
    "babel-core": "6.9.0",
    "babel-eslint": "6.0.4",
    "babel-preset-es2015": "6.9.0",
    "babel-preset-es2015-loose": "7.0.0",
    "babel-preset-stage-2": "6.5.0",
    "browserify": "12.0.1",
    "chai": "3.4.1",
    "esformatter": "0.9.2",
    "esformatter-braces": "1.2.1",
    "esformatter-dot-notation": "1.3.1",
    "esformatter-quotes": "1.0.3",
    "eslint": "2.3.0",
    "estraverse-fb": "1.3.1",
    "minami": "1.1.1",
    "mocha": "2.3.3",
    "mocha-junit-reporter": "1.9.0",
    "release-script": "0.5.4",
    "should": "7.1.1",
    "sinon": "1.17.2",
    "sinon-chai": "2.8.0",
    "streamifier": "0.1.1",
    "uglifyify": "3.0.1",
    "uglifyjs": "2.4.10"
  },
  "dependencies": {
    "form-data": "0.2.0",
    "isomorphic-fetch": "2.2.0",
    "jsonwebtoken": "5.4.1"
  },
  "release-script": {
    "bowerRepo": "git@github.com:smooch/smooch-core-js-bower.git"
  }
}

},{}]},{},[8])(8)
});